(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{288:function(t,s,a){"use strict";a.r(s);var n=a(1),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._m(1),a("p",[t._v("最近项目中有那么一个需求: 从列表页进入详情后，返回列表页时停留在列表页之前浏览到的位置。")]),a("p",[t._v("如果从传统的 js 角度思考，必然需要在状态管理中存储一个浏览位置高度的百分百，再次返回此页面时移动到偏移的位置。")]),a("p",[t._v("不过，这样的话，所有页面几乎都得设置那么一个标记，非常麻烦，有没有一种更加简单的方式，可以一劳永逸?")]),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6),t._m(7),t._m(8),t._m(9),a("p",[t._v("在没有使用 keep-alive 的时候，父组件结构如下:")]),t._m(10),a("p",[t._v("第一次进入首页，控制台打出")]),t._m(11),a("p",[t._v("跳转到其他页面，控制台打出")]),t._m(12),a("p",[t._v("再次返回首页，控制台打出")]),t._m(13),t._m(14),t._m(15),t._m(16),t._m(17),a("p",[t._v("第一次进入首页，控制台打出")]),t._m(18),a("p",[t._v("跳转到其他页面，控制台打出")]),t._m(19),a("p",[t._v("再次返回首页，控制台打出")]),t._m(20),t._m(21),t._m(22),a("p",[a("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/instance.html#%E5%AE%9E%E4%BE%8B%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90",target:"_blank",rel:"noopener noreferrer"}},[t._v("实例生命周期钩子 - vue.js"),a("OutboundLink")],1)]),a("p",[a("a",{attrs:{href:"https://cn.vuejs.org/v2/api/#keep-alive",target:"_blank",rel:"noopener noreferrer"}},[t._v("keep-alive - vue.js"),a("OutboundLink")],1)])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"vue-返回时不刷新页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-返回时不刷新页面","aria-hidden":"true"}},[this._v("$")]),this._v(" Vue 返回时不刷新页面")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[this._v("$")]),this._v(" 前言")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("查了一些资料，发现 Vue 中提供 "),s("code",[this._v("keep-alive")]),this._v(" 组件，就可实现这一需求。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"使用-keep-alive"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-keep-alive","aria-hidden":"true"}},[this._v("$")]),this._v(" 使用 keep-alive")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("通常情况下，一个 Vue 组件都会依次执行其生命周期函数，也就是 "),a("code",[t._v("beforeCreate")]),t._v(" - "),a("code",[t._v("created")]),t._v(" - "),a("code",[t._v("beforeMount")]),t._v(" - "),a("code",[t._v("mounted")]),t._v(" - "),a("code",[t._v("beforeUpdate")]),t._v(" - "),a("code",[t._v("updated")]),t._v(" - "),a("code",[t._v("beforeDestory")]),t._v(" - "),a("code",[t._v("destoryed")]),t._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果我们想要在一个组件只是第一次进入的时候执行完整的生命周期，之后进入的话从缓存中取页面，只监控其 "),s("code",[this._v("update")]),this._v(" 相关的生命周期函数，这时，使用 "),s("code",[this._v("keep-alive")]),this._v(" 再适合不过。而且由于页面不需要重新渲染，返回的时候会停留在上一次浏览到的位置，再好不过。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"一个简单的测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一个简单的测试","aria-hidden":"true"}},[this._v("$")]),this._v(" 一个简单的测试")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在我的一个叫 "),s("code",[this._v("Home.vue")]),this._v(" 的组件里面，有如下逻辑结构")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("beforeCreate")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'beforeCreate'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("created")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'created'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("beforeMount")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'beforeMount'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("mounted")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'mounted'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("beforeUpdate")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'beforeUpdate'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("updated")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'updated'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("beforeDestroy")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'beforeDestroy'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token function"}},[t._v("destroyed")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("log")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'destroyed'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"正常情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#正常情况","aria-hidden":"true"}},[this._v("$")]),this._v(" 正常情况")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-pug extra-class"},[a("pre",{pre:!0,attrs:{class:"language-pug"}},[a("code",[a("span",{attrs:{class:"token markup"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("pug"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v("\n  "),a("span",{attrs:{class:"token tag"}},[t._v(".container")]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[t._v("Home")]),t._v("\n"),a("span",{attrs:{class:"token markup"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("beforeCreate\ncreated\nbeforeMount\nmounted\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("beforeDestroy\ndestroyed\nupdated\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("beforeCreate\ncreated\nbeforeMount\nmounted\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("可以看出，整个生命周期完整执行，当跳转到其他页面的时候，组件被销毁，调用其 "),s("code",[this._v("destroy")]),this._v(" 相关的生命周期函数。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"使用-keep-alive-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-keep-alive-2","aria-hidden":"true"}},[this._v("$")]),this._v(" 使用 keep-alive")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用了 "),s("code",[this._v("keep-alive")]),this._v(" 后的父组件结构:")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-pug extra-class"},[a("pre",{pre:!0,attrs:{class:"language-pug"}},[a("code",[a("span",{attrs:{class:"token markup"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("pug"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v("\n  "),a("span",{attrs:{class:"token tag"}},[t._v(".container")]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[t._v("keep-alive")]),t._v("\n      "),a("span",{attrs:{class:"token tag"}},[t._v("Home")]),t._v("\n"),a("span",{attrs:{class:"token markup"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("beforeCreate\ncreated\nbeforeMount\nmounted\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("beforeUpdate\nupdated\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("beforeUpdate\nupdated\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("可以看到，只有第一次进入的时候，"),s("code",[this._v("create")]),this._v(" 和 "),s("code",[this._v("mount")]),this._v(" 相关的生命周期函数才执行，而 "),s("code",[this._v("destroy")]),this._v(" 相关的生命周期函数始终没有执行，说明此组件始终缓存着，没有销毁。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[this._v("$")]),this._v(" 参考资料")])}],!1,null,null,null);s.default=e.exports}}]);